copy from sam github:

https://github.com/davda54/sam
